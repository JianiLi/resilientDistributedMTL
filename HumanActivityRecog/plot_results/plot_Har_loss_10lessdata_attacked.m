clf;clc;clear;

no_coop = [0.15464754 0.1166482  0.09728974 0.08372945 0.07490876 0.06882947
 0.06212384 0.05898226 0.05318886 0.050484   0.04921786 0.04443372
 0.04312575 0.04079081 0.03893285 0.03980065 0.03543341 0.03507431
 0.03374326 0.03330533 0.03347934 0.03050023 0.02948189 0.03002763
 0.02881865 0.02681391 0.02613136 0.02615178 0.02491004 0.02385608
 0.0243845  0.02502384 0.02272802 0.02239546 0.0222341  0.02226389
 0.02225108 0.02214033 0.02049744 0.02029276 0.02002724 0.01928963
 0.01897889 0.01796512 0.01873968 0.01845903 0.0187467  0.01789998
];
no_coop = no_coop';
no_coop = reshape(no_coop, 1, 48);
no_coop = [no_coop,   0.01807287, 0.016267  ];


ave = [0.15969513 0.14065692 0.1339094  0.13107474 0.12953509 0.12856598
 0.12732093 0.12688429 0.12658045 0.12603232 0.12530569 0.12473629
 0.12437554 0.12432673 0.12398764 0.12376121 0.1234124  0.12351041
 0.12342501 0.12338173 0.12378595 0.12311237 0.12195906 0.12184938
 0.12232066 0.12209776 0.12275454 0.12301829 0.12244965 0.121802
 0.12094817 0.12153588 0.12173476 0.12119748 0.12098802 0.12140617
 0.12095047 0.1207618  0.12035    0.12026037 0.11948165 0.11983995
 0.12040557 0.12053273 0.11967936 0.11914838 0.12033592 0.11969912
 ];

ave = ave';
ave = reshape(ave, 1, 48);
ave = [ave,   0.11934109, 0.11944255];


loss = [0.15191566 0.11347223 0.09392767 0.08189518 0.07248549 0.06484371
 0.06056834 0.05513855 0.05072486 0.0475753  0.04577336 0.04261095
 0.04119431 0.0383919  0.03582379 0.03433492 0.03426282 0.03301966
 0.03133394 0.03001079 0.0289287  0.02884858 0.02716314 0.02676821
 0.02601714 0.02523229 0.02459592 0.02380676 0.02380056 0.02235342
 0.02278882 0.02178679 0.02178875 0.02114458 0.01977178 0.02028024
 0.02076461 0.01919983 0.01781017 0.01919892 0.0190083  0.01856553
 0.01790005 0.01776613 0.01780898 0.0175039  0.01620296 0.01674796
];

loss = loss';
loss = reshape(loss, 1, 48);
loss = [loss,  0.01628536, 0.01560046];


no_coop_test = [0.15285822 0.13342712 0.11938955 0.11049547 0.10451635 0.09866603
 0.09381735 0.08693029 0.08538125 0.08088913 0.07716256 0.07461803
 0.07368018 0.06965569 0.06963574 0.06667479 0.06449195 0.06224459
 0.06120162 0.059895   0.05831993 0.05769648 0.05578837 0.05558966
 0.05388012 0.05306231 0.05233777 0.05183842 0.0508138  0.0503924
 0.04909674 0.04907937 0.04808224 0.04850146 0.04693263 0.04626098
 0.04617697 0.04605635 0.04431849 0.0437352  0.04346196 0.04244732
 0.04123124 0.04048345 0.04145983 0.04148117 0.04007315 0.04031553
];
no_coop_test = no_coop_test';
no_coop_test = reshape(no_coop_test, 1, 48);
no_coop_test = [no_coop_test, 0.03958358, 0.03887556];


ave_test = [0.15409993 0.1457567  0.14033705 0.13900518 0.13714597 0.13694045
 0.13711033 0.13567883 0.1342063  0.13419932 0.13411032 0.13304849
 0.13321017 0.1333992  0.13312862 0.13248955 0.13354015 0.13326918
 0.13296039 0.13309733 0.13307758 0.1324122  0.13131609 0.13139433
 0.13111769 0.13178382 0.13218768 0.13282904 0.13151294 0.13177698
 0.13173713 0.13089142 0.13074997 0.13078535 0.13089954 0.13091054
 0.13098616 0.12981141 0.1297183  0.12934679 0.12954785 0.12934904
 0.13039489 0.12979059 0.12875963 0.12874488 0.12913322 0.12933368
];

ave_test = ave_test';
ave_test = reshape(ave_test, 1, 48);
ave_test = [ave_test,   0.12738449, 0.12932004];


loss_test = [0.13519555 0.111424   0.09713218 0.08624545 0.07863764 0.07447046
 0.07024795 0.06274656 0.06281516 0.06161755 0.05800451 0.05571468
 0.05431403 0.05230898 0.05007019 0.04932985 0.04860542 0.04724364
 0.04594622 0.04505425 0.04339108 0.04228098 0.04138143 0.0413049
 0.04015438 0.03493322 0.03843693 0.03831656 0.0390522  0.03753945
 0.03813658 0.03622489 0.03692112 0.03116437 0.03046034 0.03404225
 0.03443112 0.0335486  0.03437274 0.03361202 0.03239083 0.03282527
 0.03231984 0.03231864 0.03242815 0.03172326 0.0312857  0.0319158
];

loss_test = loss_test';
loss_test = reshape(loss_test, 1, 48);
loss_test = [loss_test, 0.03205209, 0.03095673];



set(gcf, 'Position',  [100, 100, 400, 350])
set(gcf,'color','w');
h = plot(1:10,1:10,1:10,2:11, 1:10,2:11);
c = get(h,'Color');
plot(no_coop, 'linewidth',2, 'Color', c{1});
hold on 
plot(ave, 'linewidth', 2, 'Color', c{2});
hold on 
plot(loss, 'linewidth', 2, 'Color', c{3});
plot(no_coop_test, 'linewidth', 2, 'LineStyle', '--', 'Color', c{1});
hold on 
plot(ave_test, 'linewidth', 2, 'LineStyle', '--', 'Color', c{2});
hold on 
plot(loss_test, 'linewidth', 2, 'LineStyle', '--', 'Color', c{3});
xlabel('Epoch', 'Interpreter', 'latex', 'FontSize',20);
ylabel('Average Loss', 'Interpreter', 'latex', 'FontSize',20);
% y_pct_lbl = [0 10 20 30 40 50 60 70 80 90 100];                                             % Desired Labels
% yt_orig = get(gca, 'YTick');                                            % Original Y-Tick Values & Labels
% yt_new = linspace(min(yt_orig), max(yt_orig), numel(y_pct_lbl));        % New Y-Tick Values
% yt_lbl = regexp(sprintf('%d\n', y_pct_lbl), '\n', 'split');          % New Y-Tick Labels
% set(gca, 'YTick',yt_new, 'YTickLabel',yt_lbl(1:end-1)) 

%legend('Training - No cooperation','Training - Average weights', 'Training - Loss based weights', 'Testing - No cooperation','Testing - Average weights', 'Testing - Loss based weights','Interpreter', 'latex', 'FontSize',15, 'Location', 'southeast')

%saveas(gcf,'accuracy_comparison.eps')