clf;clc;clear;

no_coop = [0.35874439 0.58741573 0.71531532 0.79061785 0.8261959  0.84327354
 0.86287016 0.86495536 0.89315068 0.89459459 0.89844444 0.91176471
 0.91156463 0.91814059 0.92725225 0.91419069 0.93173516 0.9388764
 0.93955056 0.93513514 0.93730684 0.94808126 0.9459276  0.94432071
 0.94642857 0.95941043 0.95283447 0.95730337 0.95863636 0.96278539
 0.96162528 0.95654102 0.9652968  0.96210046 0.96681716 0.96345291
 0.96428571 0.96466667 0.96794582 0.96523702 0.97094595 0.97204545
 0.97522727 0.97637615 0.97488688 0.97200903 0.97158837 0.9751693
];
no_coop = no_coop';
no_coop = reshape(no_coop, 1, 48);
no_coop = [no_coop,  0.97309417, 0.97967667];


ave = [0.3857461  0.59230769 0.62702703 0.69730942 0.71959459 0.70900901
 0.72692308 0.75045249 0.72959641 0.78081264 0.7421875  0.74524887
 0.75022523 0.7518018  0.77346939 0.71042129 0.75280899 0.72131519
 0.76415525 0.72982063 0.74134831 0.78393665 0.72426966 0.74820628
 0.74205817 0.74806378 0.76053812 0.75968109 0.74168514 0.72299107
 0.76232877 0.76328829 0.77617978 0.76964286 0.76222222 0.76292135
 0.77278912 0.77882883 0.75685393 0.75821918 0.76696429 0.78504464
 0.77096774 0.78548753 0.77065463 0.74446953 0.79752252 0.76659193
];

ave = ave';
ave = reshape(ave, 1, 48);
ave = [ave,  0.80979955, 0.7731982];


loss = [0.36326531 0.61216216 0.73423423 0.79395973 0.83923767 0.86447964
 0.88084633 0.89933185 0.90727273 0.91418919 0.91538462 0.92026726
 0.92555556 0.93475336 0.94292237 0.94636364 0.94058296 0.95224215
 0.95752809 0.95290179 0.95570776 0.95675676 0.96150342 0.96255708
 0.95986547 0.96404494 0.96577778 0.967713   0.96314607 0.9630137
 0.96981982 0.96802721 0.96860987 0.969161   0.97477064 0.97286996
 0.96895787 0.97352941 0.97819026 0.9758465  0.9731377  0.97628635
 0.97297297 0.97840909 0.97466063 0.9764574  0.97863636 0.97777778
];

loss = loss';
loss = reshape(loss, 1, 48);
loss = [loss,  0.97755102, 0.97894737];


no_coop_test = [0.40338722 0.52771363 0.60315627 0.65473441 0.68629715 0.70207852
 0.70746728 0.74788299 0.73979985 0.75750577 0.77713626 0.79368745
 0.75943033 0.80331024 0.78598922 0.79060816 0.82948422 0.83294842
 0.82448037 0.83525789 0.86951501 0.84642032 0.87682833 0.85642802
 0.85873749 0.86297152 0.86335643 0.86258661 0.87413395 0.86951501
 0.88568129 0.87644342 0.8791378  0.86874519 0.85873749 0.88645112
 0.89722864 0.87759815 0.88837567 0.8756736  0.88491147 0.90069284
 0.90877598 0.91916859 0.90069284 0.89722864 0.91070054 0.89992302
 ];
no_coop_test = no_coop_test';
no_coop_test = reshape(no_coop_test, 1, 48);
no_coop_test = [no_coop_test,   0.90454196, 0.91647421];


ave_test =[0.46458814 0.60315627 0.72055427 0.73402617 0.73556582 0.69976905
 0.68360277 0.68976135 0.73325635 0.72902232 0.72170901 0.74403387
 0.765204   0.78137028 0.66243264 0.75981524 0.67167052 0.76250962
 0.69822941 0.74749808 0.74441878 0.73903002 0.76135489 0.77290223
 0.76789838 0.76905312 0.72286374 0.63356428 0.64357198 0.75904542
 0.76905312 0.6743649  0.76404927 0.71401078 0.81254811 0.71516551
 0.76096998 0.68283295 0.79715166 0.72632794 0.71670516 0.69207082
 0.83256351 0.76366436 0.74634334 0.73787529 0.69438029 0.73287144
];

ave_test = ave_test';
ave_test = reshape(ave_test, 1, 48);
ave_test = [ave_test,  0.72055427, 0.7382602];


loss_test = [0.50808314 0.63587375 0.76327945 0.80177059 0.81370285 0.85950731
 0.85835258 0.87066975 0.88183218 0.87798306 0.87836798 0.89145497
 0.90338722 0.9095458  0.91185527 0.91070054 0.89645881 0.90916089
 0.89414935 0.91070054 0.91724403 0.91685912 0.92032333 0.92186297
 0.93071594 0.93110085 0.92686682 0.93918399 0.92840647 0.93225558
 0.93071594 0.93187067 0.92455735 0.93879908 0.93456505 0.94110855
 0.94187837 0.93418014 0.93918399 0.9330254  0.94072363 0.9361047
 0.94149346 0.94072363 0.93341032 0.94341801 0.9395689  0.94457275
];

loss_test = loss_test';
loss_test = reshape(loss_test, 1, 48);
loss_test = [loss_test,  0.93841416, 0.94765204];



set(gcf, 'Position',  [100, 100, 648, 350])
set(gcf,'color','w');
h = plot(1:10,1:10,1:10,2:11, 1:10,2:11);
c = get(h,'Color');
plot(no_coop, 'linewidth', 2, 'Color', c{1});
hold on 
plot(ave, 'linewidth', 2, 'Color', c{2});
hold on 
plot(loss, 'linewidth', 2, 'Color', c{3});
plot(no_coop_test, 'linewidth', 2, 'LineStyle', '--', 'Color', c{1});
hold on 
plot(ave_test, 'linewidth', 2, 'LineStyle', '--', 'Color', c{2});
hold on 
plot(loss_test, 'linewidth', 2, 'LineStyle', '--', 'Color', c{3});
xlabel('Epoch', 'Interpreter', 'latex', 'FontSize',20);
ylabel('Average Prediction Accuracy (\%)', 'Interpreter', 'latex', 'FontSize',20);
y_pct_lbl = [0 10 20 30 40 50 60 70 80 90 100];                                             % Desired Labels
yt_orig = get(gca, 'YTick');                                            % Original Y-Tick Values & Labels
yt_new = linspace(min(yt_orig), max(yt_orig), numel(y_pct_lbl));        % New Y-Tick Values
yt_lbl = regexp(sprintf('%d\n', y_pct_lbl), '\n', 'split');          % New Y-Tick Labels
set(gca, 'YTick',yt_new, 'YTickLabel',yt_lbl(1:end-1)) 

legend('Training - No cooperation','Training - Average weights', 'Training - Loss based weights', 'Testing - No cooperation','Testing - Average weights', 'Testing - Loss based weights','Interpreter', 'latex', 'FontSize',15, 'Location', 'eastoutside')

%saveas(gcf,'accuracy_comparison.eps')