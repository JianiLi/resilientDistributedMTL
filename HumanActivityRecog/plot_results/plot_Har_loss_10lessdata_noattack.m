clf;clc;clear;

no_coop = [0.15384757 0.11649475 0.09616517 0.08479027 0.07575871 0.06762668
 0.06294947 0.05797261 0.05456442 0.0514345  0.04876409 0.04508578
 0.04234156 0.04013932 0.03916816 0.03792224 0.03519275 0.03555367
 0.03495662 0.03113434 0.03194943 0.03184009 0.02995246 0.02868032
 0.02778926 0.02728592 0.02734183 0.0266504  0.02567008 0.02576268
 0.02459704 0.02373167 0.0234951  0.02239018 0.02334474 0.02158302
 0.02058066 0.02058707 0.02178501 0.02009695 0.01997624 0.02068777
 0.0190999  0.01858426 0.01828906 0.01873072 0.01758444 0.01699231
];
no_coop = no_coop';
no_coop = reshape(no_coop, 1, 48);
no_coop = [no_coop,  0.01800133, 0.01895846];


ave = [0.15621272 0.12846651 0.11271541 0.10251997 0.09499189 0.08874071
 0.08381209 0.07970172 0.07601871 0.07321764 0.07035519 0.06753015
 0.06515827 0.06334464 0.06141942 0.05990507 0.05820646 0.05656418
 0.05624751 0.05458411 0.0533476  0.05195764 0.05144737 0.05028562
 0.04961742 0.04808934 0.04824853 0.04687173 0.04665254 0.04556862
 0.04545472 0.0448061  0.04413276 0.04347681 0.04315069 0.04215884
 0.04169543 0.04170733 0.04092741 0.04063327 0.0399295  0.0394914
 0.03910528 0.03926013 0.03884665 0.03810901 0.03750801 0.03776915
];

ave = ave';
ave = reshape(ave, 1, 48);
ave = [ave,  0.03720015, 0.03687244];


loss = [0.1516938  0.11366409 0.09409728 0.08199025 0.0729299  0.06535949
 0.0600068  0.0548588  0.05143673 0.04789641 0.04431367 0.04266894
 0.04077311 0.03832607 0.03653095 0.03523031 0.03318821 0.03295324
 0.03191702 0.03016571 0.02925641 0.02787819 0.02748795 0.02655608
 0.02576317 0.02556999 0.02458319 0.02421322 0.02294656 0.02335445
 0.02270081 0.0221851  0.02171704 0.02097167 0.02090827 0.02033274
 0.01972594 0.01945804 0.01905813 0.01841757 0.01867161 0.01804001
 0.01771124 0.01783082 0.01706582 0.01725503 0.01724992 0.01662306
];

loss = loss';
loss = reshape(loss, 1, 48);
loss = [loss,  0.01606476, 0.01598203];


no_coop_test = [0.15201534 0.13316576 0.12130745 0.11121987 0.10304096 0.09786242
 0.09263176 0.08993423 0.08571503 0.08037512 0.07784404 0.07513604
 0.07371926 0.07065611 0.06917188 0.06694027 0.06668563 0.06428771
 0.06179141 0.06235216 0.05886927 0.0578865  0.05745065 0.05574421
 0.05536763 0.05310274 0.05287801 0.05194615 0.05156513 0.04993333
 0.05007555 0.04895883 0.04923389 0.04947157 0.04855561 0.04686464
 0.04686773 0.04569561 0.04551723 0.04418152 0.04356821 0.04274314
 0.04185788 0.04208279 0.04175747 0.04162846 0.04065463 0.04092048
];
no_coop_test = no_coop_test';
no_coop_test = reshape(no_coop_test, 1, 48);
no_coop_test = [no_coop_test,  0.03986055, 0.03971355];


ave_test = [0.14741    0.12712602 0.11411235 0.10552748 0.09876224 0.09252045
 0.08786351 0.08354234 0.07959467 0.07733019 0.07414564 0.07211526
 0.0690685  0.06703308 0.06537051 0.06388587 0.06243982 0.06079223
 0.05951394 0.05874819 0.05695303 0.05585929 0.0544928  0.05355261
 0.05294234 0.05214844 0.05122521 0.05164514 0.05041535 0.04885936
 0.04869913 0.04794639 0.04733553 0.04676444 0.04634834 0.04558637
 0.04535528 0.04456841 0.04451201 0.04349688 0.04333504 0.04322036
 0.04230378 0.04279787 0.041993   0.04146971 0.04093564 0.0409851
];

ave_test = ave_test';
ave_test = reshape(ave_test, 1, 48);
ave_test = [ave_test,  0.04017833, 0.03983563];


loss_test = [0.13501094 0.11201699 0.09762673 0.08637436 0.07876874 0.0714352
 0.06656585 0.06188368 0.05840266 0.05657909 0.05248683 0.05075468
 0.04991076 0.04771406 0.04591508 0.04347899 0.04327888 0.04168216
 0.0415109  0.04076916 0.03825359 0.03753411 0.03702785 0.03581589
 0.03500987 0.03432206 0.03432969 0.033802   0.03223644 0.03179942
 0.03229083 0.03296757 0.031788   0.03120885 0.03092709 0.02972739
 0.02985895 0.0289585  0.02813265 0.02885149 0.02787921 0.02758383
 0.02831336 0.02735788 0.02697874 0.0262206  0.02647692 0.02621363
];

loss_test = loss_test';
loss_test = reshape(loss_test, 1, 48);
loss_test = [loss_test, 0.02541965, 0.02579675];



set(gcf, 'Position',  [100, 100, 400, 350])
set(gcf,'color','w');
h = plot(1:10,1:10,1:10,2:11, 1:10,2:11);
c = get(h,'Color');
plot(no_coop, 'linewidth', 2, 'Color', c{1});
hold on 
plot(ave, 'linewidth', 2, 'Color', c{2});
hold on 
plot(loss, 'linewidth', 2, 'Color', c{3});
plot(no_coop_test, 'linewidth', 2, 'LineStyle', '--', 'Color', c{1});
hold on 
plot(ave_test, 'linewidth', 2, 'LineStyle', '--', 'Color', c{2});
hold on 
plot(loss_test, 'linewidth', 2, 'LineStyle', '--', 'Color', c{3});
xlabel('Epoch', 'Interpreter', 'latex', 'FontSize',20);
ylabel('Average Loss', 'Interpreter', 'latex', 'FontSize',20);
% y_pct_lbl = [0 10 20 30 40 50 60 70 80 90 100];                                             % Desired Labels
% yt_orig = get(gca, 'YTick');                                            % Original Y-Tick Values & Labels
% yt_new = linspace(min(yt_orig), max(yt_orig), numel(y_pct_lbl));        % New Y-Tick Values
% yt_lbl = regexp(sprintf('%d\n', y_pct_lbl), '\n', 'split');          % New Y-Tick Labels
% set(gca, 'YTick',yt_new, 'YTickLabel',yt_lbl(1:end-1)) 

%legend('Training - No cooperation','Training - Average weights', 'Training - Loss based weights', 'Testing - No cooperation','Testing - Average weights', 'Testing - Loss based weights','Interpreter', 'latex', 'FontSize',15, 'Location', 'southeast')

%saveas(gcf,'accuracy_comparison.eps')