clf;clc;clear;

no_coop = [0.03543097 0.03193385 0.02829353 0.02665211 0.02550727 0.02392057
 0.02171721 0.01975978 0.02040464 0.01903945 0.01833752 0.02823873
 0.01730394 0.01617352 0.01587229 0.01472913 0.01465039 0.01457583
 0.01523916 0.01353455 0.0135117  0.013483   0.01284288 0.01260268
 0.01457666 0.0121974  0.01196244 0.01128345 0.01128129 0.01153335
 0.01138995 0.01083082 0.01051829 0.01002716 0.01070791 0.01113869
 0.01036202 0.00986991 0.00959013 0.00972187 0.00907111 0.0090289
 0.00870498 0.00865983 0.00851986 0.00879709 0.00871094 0.00836959
 0.00815924 0.00798905 0.00793204 0.00772897 0.007901   0.00805019
 0.00737916 0.00830382 0.007326   0.00724946 0.00694262 0.00690555
 0.00746    0.00678503 0.00694775 0.00668156 0.00724294 0.00700922
 0.0064147  0.00627842 0.00635751 0.0065432  0.00634838 0.00618485
 0.00630238 0.00663168 0.00577346 0.00634133 0.00624868 0.00586364
 0.00602409 0.00637392 0.0060428  0.00584513 0.00543224 0.00537212
 0.00610555 0.00586827 0.00531801 0.00537553 0.00531944 0.00511776
 0.00373526 0.00538309 0.00538205 0.00530336 0.00492996 0.00492678
];
no_coop = no_coop';
no_coop = reshape(no_coop, 1, 96);
no_coop = [no_coop,   0.00519287, 0.00482463, 0.00519558, 0.00489951];


ave = [0.03695142 0.03754446 0.03581159 0.03350848 0.0306295  0.02841508
 0.02757986 0.02615008 0.02150188 0.02426484 0.02058821 0.02363432
 0.02201079 0.02152091 0.02108747 0.02104706 0.02006081 0.01991494
 0.01886488 0.0191204  0.01867931 0.01844635 0.01770295 0.01806196
 0.01708799 0.01734138 0.01681628 0.01714427 0.01628772 0.01644414
 0.01591005 0.01546873 0.01573313 0.01502501 0.01555439 0.0150015
 0.01475824 0.01440624 0.01434691 0.01420057 0.01437381 0.01416364
 0.0138159  0.01409387 0.01417516 0.01340043 0.01296514 0.01317054
 0.01322371 0.01280793 0.01263061 0.01307403 0.01273999 0.01352621
 0.01429961 0.01293431 0.01272334 0.01175714 0.01176201 0.01191825
 0.01218139 0.01186799 0.01192756 0.01157419 0.01148369 0.01120987
 0.01121117 0.00890974 0.01075222 0.01080134 0.01134948 0.01076926
 0.0109265  0.01034878 0.01070915 0.01027905 0.01049321 0.01070714
 0.01043821 0.01058232 0.0103314  0.01010352 0.0100426  0.00983448
 0.00967244 0.00979935 0.00952962 0.00963285 0.00972612 0.00953639
 0.00944954 0.00925271 0.00944879 0.00895444 0.00962525 0.00947179
];

ave = ave';
ave = reshape(ave, 1, 96);
ave = [ave,  0.00901926, 0.00880177, 0.00922904, 0.00736919];


loss = [0.0338186  0.02452638 0.02085147 0.01859043 0.01584057 0.0139337
 0.01223693 0.01155088 0.0104428  0.00999179 0.00953845 0.00892597
 0.00874254 0.00823402 0.00827748 0.0078898  0.00746555 0.00704816
 0.00664834 0.00684496 0.00632903 0.00616486 0.00585853 0.00597582
 0.00580551 0.00427615 0.00496482 0.00460773 0.00481716 0.00462262
 0.00476413 0.00456155 0.00456221 0.00450636 0.0044172  0.00433473
 0.00439656 0.00343719 0.00435716 0.00413599 0.00369925 0.00361279
 0.00392111 0.00392535 0.00350786 0.00326719 0.00340774 0.0031595
 0.00334071 0.00288831 0.00330191 0.003084   0.00337575 0.00317698
 0.00305207 0.00294241 0.00304545 0.00306066 0.00326545 0.00310537
 0.00269626 0.00280499 0.00315408 0.00265876 0.00259204 0.00316581
 0.00295759 0.00285825 0.00295822 0.00278672 0.00300816 0.00275853
 0.00262503 0.00252682 0.00252564 0.00265473 0.00232673 0.00221233
 0.00240914 0.00236214 0.00222725 0.00214298 0.00215081 0.00212439
 0.00210617 0.00201495 0.00192171 0.00198491 0.00217192 0.00188926
 0.00199904 0.0017986  0.00194834 0.0015915  0.00179353 0.00184487
];

loss = loss';
loss = reshape(loss, 1, 96);
loss = [loss,  0.00183546, 0.0018577,  0.00171646, 0.00173115];


no_coop_test = [0.03749451 0.03303082 0.03091106 0.02914826 0.02722068 0.02571869
 0.02401551 0.02329282 0.02210049 0.02123589 0.02046875 0.01952653
 0.01860723 0.018082   0.01738279 0.01715634 0.01670298 0.01666185
 0.01594681 0.01586966 0.01560375 0.01541905 0.0154804  0.01503733
 0.01424198 0.01454287 0.01430034 0.01368991 0.01355416 0.01337515
 0.01358489 0.0130539  0.01328317 0.01257318 0.01279162 0.01221419
 0.01235671 0.01175906 0.01183526 0.01189142 0.01141554 0.01114373
 0.01121995 0.01105265 0.01061109 0.01091643 0.01049405 0.0105684
 0.01031697 0.01029377 0.01032925 0.01031639 0.01000591 0.00970707
 0.01007302 0.00995485 0.00944072 0.00990639 0.01010644 0.00962195
 0.00952099 0.00944603 0.00931311 0.00941395 0.00943045 0.0091928
 0.00893298 0.00932178 0.0092343  0.00906578 0.00930517 0.00889775
 0.00891858 0.00890232 0.00889095 0.00910169 0.00898117 0.00906488
 0.00884009 0.00853894 0.00817759 0.00861018 0.00848952 0.00806082
 0.00826188 0.00819337 0.00810953 0.00783338 0.00792464 0.00777684
 0.00786401 0.00798593 0.0077688  0.00796195 0.00805808 0.00745903
];
no_coop_test = no_coop_test';
no_coop_test = reshape(no_coop_test, 1, 96);
no_coop_test = [no_coop_test,  0.00750183, 0.00766464, 0.00768388, 0.00769445];


ave_test = [0.04029853 0.04020651 0.03919269 0.0349293  0.03280083 0.0308474
 0.03019366 0.02830919 0.02724684 0.02708655 0.02580834 0.02473359
 0.02396003 0.02323516 0.02245337 0.02188545 0.02121736 0.02091321
 0.02053461 0.02017925 0.01939919 0.01926497 0.01890942 0.01883557
 0.0182904  0.01788315 0.01764635 0.0176081  0.01717054 0.01683732
 0.01655651 0.01639679 0.01652491 0.01615049 0.01601767 0.01580441
 0.01589755 0.01527582 0.01528873 0.01501288 0.01506466 0.01482211
 0.01464621 0.01436609 0.01421361 0.01439172 0.01381579 0.014116
 0.01371216 0.01377739 0.01356987 0.01344659 0.01359919 0.01313382
 0.01330271 0.01313141 0.01293075 0.01279284 0.01267386 0.01288115
 0.01248903 0.01238367 0.01213153 0.01228369 0.01226013 0.01217788
 0.01191491 0.01180439 0.01177209 0.01149901 0.01149676 0.01156552
 0.01143019 0.01138492 0.01126661 0.01117149 0.01121953 0.01135918
 0.01138577 0.01124646 0.01108739 0.01092326 0.01078294 0.01069712
 0.01069208 0.01055553 0.01050498 0.01063986 0.01069657 0.01037328
 0.01043141 0.01037342 0.01028201 0.01013978 0.01011748 0.0102315
];

ave_test = ave_test';
ave_test = reshape(ave_test, 1, 96);
ave_test = [ave_test,  0.00982214, 0.00976113, 0.01001552, 0.00984433];


loss_test = [0.03055817 0.02457201 0.02221579 0.01914552 0.01674019 0.01429122
 0.01351658 0.01269739 0.01181561 0.01143799 0.01077462 0.01055742
 0.01002284 0.00954207 0.00939037 0.00919019 0.0086446  0.00819272
 0.00826044 0.00791671 0.00805715 0.00777391 0.00740679 0.00729566
 0.00737395 0.0069833  0.00703933 0.00672496 0.00672492 0.00656435
 0.00654313 0.00633646 0.00655559 0.00639211 0.00607457 0.00629589
 0.00618911 0.00593351 0.00628974 0.0060026  0.0058009  0.00574716
 0.00603376 0.00599796 0.00569474 0.00575677 0.00560757 0.00560661
 0.005473   0.00526033 0.00559424 0.00549188 0.00538527 0.00571496
 0.00549508 0.00547518 0.00563275 0.00511611 0.00539086 0.00534788
 0.00542748 0.00554259 0.00544317 0.00563857 0.00584928 0.0055227
 0.00556784 0.00529846 0.00555131 0.00538391 0.00519193 0.00493507
 0.0048721  0.00500462 0.00519184 0.00473277 0.00477073 0.004917
 0.00492222 0.0047164  0.00475034 0.00483057 0.00496912 0.00497245
 0.00473047 0.00517354 0.00512075 0.00488229 0.00463697 0.00479464
 0.00478909 0.00486529 0.00474358 0.00443918 0.00450323 0.00454491
 ];

loss_test = loss_test';
loss_test = reshape(loss_test, 1, 96);
loss_test = [loss_test,  0.0045309,  0.0043417,  0.00449057, 0.00443045];



set(gcf, 'Position',  [100, 100, 400, 350])
set(gcf,'color','w');
h = plot(1:10,1:10,1:10,2:11, 1:10,2:11);
c = get(h,'Color');
plot(no_coop, 'linewidth', 2, 'Color', c{1});
hold on 
plot(ave, 'linewidth', 2, 'Color', c{2});
hold on 
plot(loss, 'linewidth', 2, 'Color', c{3});
plot(no_coop_test, 'linewidth', 2, 'LineStyle', '--', 'Color', c{1});
hold on 
plot(ave_test, 'linewidth', 2, 'LineStyle', '--', 'Color', c{2});
hold on 
plot(loss_test, 'linewidth', 2, 'LineStyle', '--', 'Color', c{3});
xlabel('Epoch', 'Interpreter', 'latex', 'FontSize',20);
ylabel('Average Loss', 'Interpreter', 'latex', 'FontSize',20);
% y_pct_lbl = [0 10 20 30 40 50 60 70 80 90 100];                                             % Desired Labels
% yt_orig = get(gca, 'YTick');                                            % Original Y-Tick Values & Labels
% yt_new = linspace(min(yt_orig), max(yt_orig), numel(y_pct_lbl));        % New Y-Tick Values
% yt_lbl = regexp(sprintf('%d\n', y_pct_lbl), '\n', 'split');          % New Y-Tick Labels
% set(gca, 'YTick',yt_new, 'YTickLabel',yt_lbl(1:end-1)) 

%legend('Training - No cooperation','Training - Average weights', 'Training - Loss based weights', 'Testing - No cooperation','Testing - Average weights', 'Testing - Loss based weights','Interpreter', 'latex', 'FontSize',15, 'Location', 'southeast')

%saveas(gcf,'accuracy_comparison.eps')